<!-- Configuración de Apariencia y Tema - Phase 9 -->
<div class="admin-container">
    <div class="admin-header">
        <div>
            <h2><i class="bi bi-palette"></i> Configuración de Apariencia</h2>
            <p class="text-muted">Personaliza colores, tipografía, marca y diseño del sistema</p>
        </div>
        <div class="user-actions">
            <button type="button" class="btn btn-sm btn-success" id="save-config-btn">
                <i class="bi bi-save"></i> Guardar Cambios
            </button>
            <a href="/admin" class="btn btn-sm btn-secondary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    <!-- Alert Messages -->
    <div id="alert-container"></div>

    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="colors-tab" data-bs-toggle="tab" data-bs-target="#colors" type="button" role="tab">
                <i class="bi bi-palette-fill"></i> Colores
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="typography-tab" data-bs-toggle="tab" data-bs-target="#typography" type="button" role="tab">
                <i class="bi bi-fonts"></i> Tipografía
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="branding-tab" data-bs-toggle="tab" data-bs-target="#branding" type="button" role="tab">
                <i class="bi bi-award"></i> Marca
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="layout-tab" data-bs-toggle="tab" data-bs-target="#layout" type="button" role="tab">
                <i class="bi bi-layout-sidebar"></i> Diseño
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="advanced-tab" data-bs-toggle="tab" data-bs-target="#advanced" type="button" role="tab">
                <i class="bi bi-gear"></i> Avanzado
            </button>
        </li>
    </ul>

    <!-- Tabs Content -->
    <div class="tab-content" id="appearanceTabContent">

        <!-- COLORS TAB -->
        <div class="tab-pane fade show active" id="colors" role="tabpanel" aria-labelledby="colors-tab">
            <div class="settings-section">
                <h3><i class="bi bi-palette-fill"></i> Paleta de Colores</h3>
                <p class="text-muted mb-4">Personaliza los colores principales del tema. Los cambios se reflejarán en tiempo real.</p>

                <div class="colors-grid">
                    {{#colors}}
                    <div class="color-item">
                        <label for="color-{{name}}" class="color-label">
                            <span class="color-name">{{name}}</span>
                            <span class="color-usage">{{usage}}</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color"
                                   class="color-picker"
                                   id="color-{{name}}"
                                   name="color-{{name}}"
                                   value="{{hex}}"
                                   data-color-name="{{name}}">
                            <input type="text"
                                   class="hex-input"
                                   id="hex-{{name}}"
                                   value="{{hex}}"
                                   pattern="^#[0-9A-Fa-f]{6}$"
                                   maxlength="7">
                        </div>
                        <div class="color-preview" style="background-color: {{hex}};"></div>
                        <div class="contrast-info" id="contrast-{{name}}">
                            <small>Ratio: <span class="contrast-ratio">-</span></small>
                        </div>
                    </div>
                    {{/colors}}
                    {{^colors}}
                    <div class="color-item">
                        <label for="color-primary" class="color-label">
                            <span class="color-name">Primary</span>
                            <span class="color-usage">Botones principales</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-primary" name="color-primary" value="#2c7be5">
                            <input type="text" class="hex-input" id="hex-primary" value="#2c7be5">
                        </div>
                        <div class="color-preview" style="background-color: #2c7be5;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-secondary" class="color-label">
                            <span class="color-name">Secondary</span>
                            <span class="color-usage">Elementos secundarios</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-secondary" name="color-secondary" value="#6e84a3">
                            <input type="text" class="hex-input" id="hex-secondary" value="#6e84a3">
                        </div>
                        <div class="color-preview" style="background-color: #6e84a3;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-success" class="color-label">
                            <span class="color-name">Success</span>
                            <span class="color-usage">Mensajes de éxito</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-success" name="color-success" value="#00d97e">
                            <input type="text" class="hex-input" id="hex-success" value="#00d97e">
                        </div>
                        <div class="color-preview" style="background-color: #00d97e;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-danger" class="color-label">
                            <span class="color-name">Danger</span>
                            <span class="color-usage">Errores y alertas</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-danger" name="color-danger" value="#e63757">
                            <input type="text" class="hex-input" id="hex-danger" value="#e63757">
                        </div>
                        <div class="color-preview" style="background-color: #e63757;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-warning" class="color-label">
                            <span class="color-name">Warning</span>
                            <span class="color-usage">Advertencias</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-warning" name="color-warning" value="#f6c343">
                            <input type="text" class="hex-input" id="hex-warning" value="#f6c343">
                        </div>
                        <div class="color-preview" style="background-color: #f6c343;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-info" class="color-label">
                            <span class="color-name">Info</span>
                            <span class="color-usage">Información</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-info" name="color-info" value="#39afd1">
                            <input type="text" class="hex-input" id="hex-info" value="#39afd1">
                        </div>
                        <div class="color-preview" style="background-color: #39afd1;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-light" class="color-label">
                            <span class="color-name">Light</span>
                            <span class="color-usage">Fondos claros</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-light" name="color-light" value="#f9fafd">
                            <input type="text" class="hex-input" id="hex-light" value="#f9fafd">
                        </div>
                        <div class="color-preview" style="background-color: #f9fafd; border: 1px solid #ddd;"></div>
                    </div>
                    <div class="color-item">
                        <label for="color-dark" class="color-label">
                            <span class="color-name">Dark</span>
                            <span class="color-usage">Fondos oscuros</span>
                        </label>
                        <div class="color-input-group">
                            <input type="color" class="color-picker" id="color-dark" name="color-dark" value="#0b1727">
                            <input type="text" class="hex-input" id="hex-dark" value="#0b1727">
                        </div>
                        <div class="color-preview" style="background-color: #0b1727;"></div>
                    </div>
                    {{/colors}}
                </div>

                <div class="action-buttons mt-4">
                    <button type="button" class="btn btn-warning" id="reset-colors-btn">
                        <i class="bi bi-arrow-counterclockwise"></i> Restaurar Colores Predeterminados
                    </button>
                </div>
            </div>
        </div>

        <!-- TYPOGRAPHY TAB -->
        <div class="tab-pane fade" id="typography" role="tabpanel" aria-labelledby="typography-tab">
            <div class="settings-section">
                <h3><i class="bi bi-fonts"></i> Tipografía</h3>
                <p class="text-muted mb-4">Selecciona las fuentes para encabezados, cuerpo y código.</p>

                <div class="typography-grid">
                    <div class="typography-item">
                        <label for="font-heading" class="form-label">Fuente para Encabezados</label>
                        <select class="form-select" id="font-heading" name="font-heading">
                            {{#available_fonts}}
                            <option value="{{value}}" {{#selected}}selected{{/selected}}>{{label}}</option>
                            {{/available_fonts}}
                            {{^available_fonts}}
                            <option value="Montserrat, sans-serif">Montserrat</option>
                            <option value="Open Sans, sans-serif">Open Sans</option>
                            <option value="Roboto, sans-serif">Roboto</option>
                            <option value="Lato, sans-serif">Lato</option>
                            <option value="Poppins, sans-serif">Poppins</option>
                            {{/available_fonts}}
                        </select>
                        <div class="font-preview mt-2" style="font-family: var(--font-heading);">
                            <h3>Ejemplo de Encabezado</h3>
                        </div>
                    </div>

                    <div class="typography-item">
                        <label for="font-body" class="form-label">Fuente para Cuerpo de Texto</label>
                        <select class="form-select" id="font-body" name="font-body">
                            {{#available_fonts}}
                            <option value="{{value}}" {{#selected}}selected{{/selected}}>{{label}}</option>
                            {{/available_fonts}}
                            {{^available_fonts}}
                            <option value="Open Sans, sans-serif" selected>Open Sans</option>
                            <option value="Roboto, sans-serif">Roboto</option>
                            <option value="Lato, sans-serif">Lato</option>
                            <option value="Source Sans Pro, sans-serif">Source Sans Pro</option>
                            {{/available_fonts}}
                        </select>
                        <div class="font-preview mt-2" style="font-family: var(--font-body);">
                            <p>Este es un ejemplo de texto de cuerpo con la fuente seleccionada.</p>
                        </div>
                    </div>

                    <div class="typography-item">
                        <label for="font-mono" class="form-label">Fuente Monoespaciada (Código)</label>
                        <select class="form-select" id="font-mono" name="font-mono">
                            <option value="Courier New, monospace" selected>Courier New</option>
                            <option value="Monaco, monospace">Monaco</option>
                            <option value="Consolas, monospace">Consolas</option>
                        </select>
                        <div class="font-preview mt-2" style="font-family: var(--font-mono); background: #f5f5f5; padding: 10px; border-radius: 4px;">
                            <code>const example = "Hello World";</code>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BRANDING TAB -->
        <div class="tab-pane fade" id="branding" role="tabpanel" aria-labelledby="branding-tab">
            <div class="settings-section">
                <h3><i class="bi bi-award"></i> Marca e Identidad</h3>
                <p class="text-muted mb-4">Personaliza el logo, favicon y nombre del sitio.</p>

                <div class="info-box info-info mb-4">
                    <i class="bi bi-info-circle"></i>
                    <div>
                        <strong>Próximamente:</strong> La funcionalidad de carga de logos y favicon estará disponible en la próxima actualización.
                        Por ahora, puedes configurar URLs directas.
                    </div>
                </div>

                <div class="branding-grid">
                    <div class="form-group">
                        <label for="site-name">Nombre del Sitio</label>
                        <input type="text" class="form-control" id="site-name" placeholder="NexoSupport" value="{{config.site_name}}">
                    </div>

                    <div class="form-group">
                        <label for="site-tagline">Eslogan</label>
                        <input type="text" class="form-control" id="site-tagline" placeholder="Sistema de Soporte Integral" value="{{config.site_tagline}}">
                    </div>

                    <div class="form-group">
                        <label for="logo-url">URL del Logo (Modo Claro)</label>
                        <input type="url" class="form-control" id="logo-url" placeholder="/assets/images/logo.png" value="{{config.logo_url}}">
                    </div>

                    <div class="form-group">
                        <label for="logo-dark-url">URL del Logo (Modo Oscuro)</label>
                        <input type="url" class="form-control" id="logo-dark-url" placeholder="/assets/images/logo-dark.png" value="{{config.logo_dark_url}}">
                    </div>

                    <div class="form-group">
                        <label for="favicon-url">URL del Favicon</label>
                        <input type="url" class="form-control" id="favicon-url" placeholder="/assets/images/favicon.ico" value="{{config.favicon_url}}">
                    </div>
                </div>
            </div>
        </div>

        <!-- LAYOUT TAB -->
        <div class="tab-pane fade" id="layout" role="tabpanel" aria-labelledby="layout-tab">
            <div class="settings-section">
                <h3><i class="bi bi-layout-sidebar"></i> Diseño y Distribución</h3>
                <p class="text-muted mb-4">Configura el diseño general de la interfaz.</p>

                <div class="layout-grid">
                    <div class="form-group">
                        <label for="default-layout">Diseño Predeterminado</label>
                        <select class="form-select" id="default-layout">
                            <option value="sidebar-left" selected>Barra Lateral Izquierda</option>
                            <option value="sidebar-right">Barra Lateral Derecha</option>
                            <option value="top-nav">Navegación Superior</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="sidebar-width">Ancho de Barra Lateral</label>
                        <input type="text" class="form-control" id="sidebar-width" placeholder="250px" value="{{config.sidebar_width}}">
                    </div>

                    <div class="form-group">
                        <label for="navbar-height">Altura de Barra de Navegación</label>
                        <input type="text" class="form-control" id="navbar-height" placeholder="60px" value="{{config.navbar_height}}">
                    </div>

                    <div class="form-group">
                        <label for="container-width">Ancho Máximo del Contenedor</label>
                        <input type="text" class="form-control" id="container-width" placeholder="1400px" value="{{config.container_width}}">
                    </div>

                    <div class="form-group">
                        <label class="form-label d-block">Modo Oscuro</label>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="dark-mode-toggle">
                            <label class="form-check-label" for="dark-mode-toggle">
                                Activar modo oscuro por defecto
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ADVANCED TAB -->
        <div class="tab-pane fade" id="advanced" role="tabpanel" aria-labelledby="advanced-tab">
            <div class="settings-section">
                <h3><i class="bi bi-gear"></i> Opciones Avanzadas</h3>
                <p class="text-muted mb-4">Exportar, importar y respaldar configuraciones de tema.</p>

                <!-- Export/Import -->
                <div class="advanced-section">
                    <h4><i class="bi bi-download"></i> Exportar/Importar Configuración</h4>
                    <p class="text-muted">Descarga tu configuración actual o importa una previamente guardada.</p>

                    <div class="action-buttons">
                        <button type="button" class="btn btn-primary" id="export-config-btn">
                            <i class="bi bi-download"></i> Exportar Configuración (JSON)
                        </button>
                        <button type="button" class="btn btn-secondary" id="import-config-btn">
                            <i class="bi bi-upload"></i> Importar Configuración
                        </button>
                        <input type="file" id="import-file-input" accept=".json" style="display: none;">
                    </div>
                </div>

                <!-- Backups -->
                <div class="advanced-section mt-5">
                    <h4><i class="bi bi-clock-history"></i> Respaldos de Configuración</h4>
                    <p class="text-muted">Crea puntos de restauración de tu configuración actual.</p>

                    <div class="backup-actions mb-3">
                        <div class="input-group" style="max-width: 400px;">
                            <input type="text" class="form-control" id="backup-name-input" placeholder="Nombre del respaldo">
                            <button class="btn btn-success" type="button" id="create-backup-btn">
                                <i class="bi bi-plus-circle"></i> Crear Respaldo
                            </button>
                        </div>
                    </div>

                    <div class="backups-list" id="backups-list">
                        <div class="text-center text-muted py-4">
                            <i class="bi bi-inbox" style="font-size: 3rem;"></i>
                            <p>No hay respaldos guardados</p>
                        </div>
                    </div>
                </div>

                <!-- CSS Regeneration -->
                <div class="advanced-section mt-5">
                    <h4><i class="bi bi-arrow-clockwise"></i> Regenerar CSS</h4>
                    <p class="text-muted">Fuerza la regeneración del archivo CSS dinámico con la configuración actual.</p>

                    <button type="button" class="btn btn-warning" id="regenerate-css-btn">
                        <i class="bi bi-arrow-clockwise"></i> Regenerar CSS Ahora
                    </button>
                </div>

                <!-- Reset All -->
                <div class="advanced-section mt-5">
                    <h4><i class="bi bi-exclamation-triangle"></i> Restaurar Todo</h4>
                    <p class="text-muted text-danger">Esto restaurará TODA la configuración a los valores predeterminados de fábrica.</p>

                    <button type="button" class="btn btn-danger" id="reset-all-btn">
                        <i class="bi bi-arrow-counterclockwise"></i> Restaurar a Valores Predeterminados
                    </button>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Include JavaScript for theme configuration -->
<script src="/assets/js/appearance-config.js"></script>

<style>
/* Base Admin Container */
.admin-container {
    padding: 20px 0;
    max-width: 1400px;
    margin: 0 auto;
}

.admin-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border-color);
}

.admin-header h2 {
    color: var(--text-primary);
    margin: 0 0 5px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.text-muted {
    color: var(--text-secondary);
    margin: 0;
}

.user-actions {
    display: flex;
    gap: 10px;
}

/* Alert Container */
#alert-container {
    margin-bottom: 20px;
}

.alert {
    padding: 15px 20px;
    border-radius: 8px;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.alert-success {
    background: #d4edda;
    color: #155724;
    border-left: 4px solid #28a745;
}

.alert-danger {
    background: #f8d7da;
    color: #721c24;
    border-left: 4px solid #dc3545;
}

.alert-warning {
    background: #fff3cd;
    color: #856404;
    border-left: 4px solid #ffc107;
}

/* Tabs */
.nav-tabs {
    border-bottom: 2px solid var(--border-color);
    margin-bottom: 30px;
}

.nav-tabs .nav-link {
    color: var(--text-secondary);
    border: none;
    padding: 12px 20px;
    margin-right: 5px;
    transition: all 0.3s;
}

.nav-tabs .nav-link:hover {
    color: var(--text-primary);
    background: var(--bg-secondary);
}

.nav-tabs .nav-link.active {
    color: var(--iser-green);
    background: var(--bg-secondary);
    border-bottom: 3px solid var(--iser-green);
}

.nav-tabs .nav-link i {
    margin-right: 5px;
}

/* Settings Section */
.settings-section {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 30px;
}

.settings-section h3 {
    color: var(--text-primary);
    margin: 0 0 10px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.settings-section h3 i {
    color: var(--iser-green);
}

/* Colors Grid */
.colors-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.color-item {
    background: var(--bg-primary);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.color-label {
    display: flex;
    flex-direction: column;
    margin-bottom: 10px;
}

.color-name {
    font-weight: 600;
    color: var(--text-primary);
    text-transform: capitalize;
}

.color-usage {
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.color-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 10px;
}

.color-picker {
    width: 60px;
    height: 40px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: pointer;
}

.hex-input {
    flex: 1;
    padding: 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-family: monospace;
    text-transform: uppercase;
}

.color-preview {
    height: 40px;
    border-radius: 4px;
    margin-bottom: 10px;
}

.contrast-info {
    font-size: 0.75rem;
    color: var(--text-secondary);
}

/* Typography Grid */
.typography-grid {
    display: grid;
    gap: 30px;
    margin-top: 20px;
}

.typography-item {
    background: var(--bg-primary);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-primary);
}

.form-select, .form-control {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-secondary);
    color: var(--text-primary);
}

.font-preview {
    padding: 15px;
    background: var(--bg-secondary);
    border-radius: 4px;
    border: 1px solid var(--border-color);
}

/* Branding & Layout Grids */
.branding-grid, .layout-grid {
    display: grid;
    gap: 20px;
    margin-top: 20px;
}

.form-group {
    background: var(--bg-primary);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

/* Info Boxes */
.info-box {
    padding: 20px;
    border-radius: 8px;
    display: flex;
    gap: 15px;
}

.info-box i {
    font-size: 1.5rem;
    flex-shrink: 0;
}

.info-box.info-info {
    background: #d1ecf1;
    color: #0c5460;
    border-left: 4px solid #17a2b8;
}

/* Advanced Section */
.advanced-section {
    padding: 25px;
    background: var(--bg-primary);
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.advanced-section h4 {
    color: var(--text-primary);
    margin: 0 0 10px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.advanced-section h4 i {
    color: var(--iser-green);
}

.action-buttons {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 15px;
}

/* Backups List */
.backups-list {
    margin-top: 20px;
    max-height: 400px;
    overflow-y: auto;
}

.backup-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background: var(--bg-secondary);
    border-radius: 8px;
    margin-bottom: 10px;
    border: 1px solid var(--border-color);
}

.backup-info {
    flex: 1;
}

.backup-name {
    font-weight: 600;
    color: var(--text-primary);
}

.backup-date {
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.backup-actions {
    display: flex;
    gap: 10px;
}

/* Buttons */
.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9375rem;
    font-weight: 500;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-sm {
    padding: 8px 16px;
    font-size: 0.875rem;
}

.btn-primary {
    background: var(--iser-green);
    color: white;
}

.btn-primary:hover {
    background: #00b369;
}

.btn-secondary {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.btn-secondary:hover {
    background: var(--border-color);
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-success:hover {
    background: #218838;
}

.btn-warning {
    background: #ffc107;
    color: #212529;
}

.btn-warning:hover {
    background: #e0a800;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.btn-danger:hover {
    background: #c82333;
}

/* Form Switches */
.form-check-input {
    width: 3em;
    height: 1.5em;
    cursor: pointer;
}

.form-check-label {
    margin-left: 10px;
    color: var(--text-primary);
}

/* Responsive */
@media (max-width: 768px) {
    .colors-grid {
        grid-template-columns: 1fr;
    }

    .admin-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .user-actions {
        width: 100%;
    }

    .nav-tabs .nav-link {
        font-size: 0.875rem;
        padding: 10px 15px;
    }
}
</style>
