<header class="site-header bg-white border-bottom shadow-sm sticky-top">
    <div class="container-fluid">
        <div class="d-flex align-items-center justify-content-between py-3">
            <!-- Logo y nombre del sitio -->
            <div class="d-flex align-items-center">
                <a href="/" class="logo-link text-decoration-none">
                    <img src="{{{logo_url}}}" alt="{{site_name}}" class="site-logo" height="40">
                    <span class="site-name ms-2 fs-4 fw-bold text-dark d-none d-md-inline">{{site_name}}</span>
                </a>
            </div>

            <!-- Barra de búsqueda (opcional) -->
            {{#show_search}}
            <div class="header-search flex-grow-1 mx-4 d-none d-lg-block">
                <form action="/search" method="GET" class="search-form">
                    <div class="input-group">
                        <input type="text" name="q" class="form-control" placeholder="Buscar..." aria-label="Buscar">
                        <button class="btn btn-outline-secondary" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
            {{/show_search}}

            <!-- Acciones del header -->
            <div class="header-actions d-flex align-items-center gap-2">
                <!-- Toggle de tema oscuro/claro -->
                <button class="btn btn-link theme-toggle" title="Cambiar tema" aria-label="Cambiar tema">
                    <i class="fas fa-moon"></i>
                </button>

                <!-- Notificaciones -->
                {{#user.authenticated}}
                <div class="dropdown">
                    <button class="btn btn-link position-relative" type="button" id="notificationsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-bell"></i>
                        {{#notifications_count}}
                        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                            {{notifications_count}}
                            <span class="visually-hidden">notificaciones sin leer</span>
                        </span>
                        {{/notifications_count}}
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationsDropdown">
                        <li><h6 class="dropdown-header">Notificaciones</h6></li>
                        {{#notifications}}
                        <li><a class="dropdown-item" href="{{{url}}}">{{{message}}}</a></li>
                        {{/notifications}}
                        {{^notifications}}
                        <li><span class="dropdown-item-text text-muted">No hay notificaciones nuevas</span></li>
                        {{/notifications}}
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-center" href="/notifications">Ver todas</a></li>
                    </ul>
                </div>

                <!-- Menú de usuario -->
                <div class="dropdown">
                    <button class="btn btn-link d-flex align-items-center text-decoration-none" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="{{user.avatar}}" alt="{{user.name}}" class="rounded-circle me-2" width="32" height="32">
                        <span class="d-none d-md-inline">{{user.name}}</span>
                        <i class="fas fa-chevron-down ms-1 small"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                        <li><h6 class="dropdown-header">{{user.name}}</h6></li>
                        <li><a class="dropdown-item" href="/profile"><i class="fas fa-user me-2"></i>Mi Perfil</a></li>
                        <li><a class="dropdown-item" href="/user/preferences"><i class="fas fa-cog me-2"></i>Preferencias</a></li>
                        {{#user.is_admin}}
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/admin"><i class="fas fa-tools me-2"></i>Administración</a></li>
                        {{/user.is_admin}}
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="/logout"><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a></li>
                    </ul>
                </div>
                {{/user.authenticated}}

                {{^user.authenticated}}
                <!-- Botones para usuarios no autenticados -->
                <a href="/login" class="btn btn-outline-primary">Iniciar Sesión</a>
                <a href="/register" class="btn btn-primary">Registrarse</a>
                {{/user.authenticated}}

                <!-- Toggle del sidebar en móviles -->
                <button class="btn btn-link sidebar-toggle d-md-none" aria-label="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </div>
</header>
